tosca_definitions_version: cloudify_dsl_1_1
imports:
  - http://www.getcloudify.org/spec/cloudify/3.2.1/types.yaml
  - https://raw.githubusercontent.com/tonybaloney/cloudify-libcloud-plugin/dimensiondata_support/plugin.yaml

inputs:
  agent_user:
    description: >
      User name used when SSH-ing into the started machine
  agent_private_key_path:
    description: >
      Path to a private key that resided on the management machine.
      SSH-ing into agent machines will be done with this key.
  vm_name:
    description: >
      Name of the node to create
  node_description:
    description: >
      Description of the node to create
  node_password:
    description: >
      The root/admin password of the new server (node)
  network_name:
    description: >
      Name of the MCP 1.0 network to create the node into
  image_name:
    description: >
      Name of the base image to use
  location:
    description: >
      The data center ID (e.g. NA9)

node_templates:
  host:
    type: cloudify.libcloud.nodes.Server
    properties:
      server:
        name: { get_input: vm_name }
        image_name: { get_input: image_name }
        network_name: { get_input: network_name }
        node_description: { get_input: node_description }
        node_password: { get_input: node_password }
        location: { get_input: location }
      install_agent: false
      cloudify_agent:
        user: { get_input: agent_user }
        key: { get_input: agent_private_key_path }